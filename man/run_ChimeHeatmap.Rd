% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_ChimeHeatmap.R
\name{run_ChimeHeatmap}
\alias{run_ChimeHeatmap}
\title{Step 4: Heatmap of top ligand–receptor (LR) pairs using pheatmap}
\usage{
run_ChimeHeatmap(
  lr_scores,
  stat_results,
  n_top = 20,
  fdr_thr = 0.05,
  pair_column = c("pair", "pair_human"),
  sample_order = c(paste0("Control_", 1:3), paste0("Treatment_", 1:3)),
  cluster_rows = TRUE,
  cluster_cols = FALSE,
  scale_rows = TRUE,
  palette = "RdBu",
  palette_n = 100,
  palette_rev = TRUE,
  breaks = NULL,
  fontsize_row = 12,
  fontsize_col = 12,
  border_color = "white",
  show_rownames = TRUE,
  ...
)
}
\arguments{
\item{lr_scores}{Data frame from \code{get_ChimeLRscore()}.}

\item{stat_results}{Data frame from \code{get_ChimeStatistics()} (must contain
\code{pair}, \code{p.adj}, \code{t}, and \code{delta}).}

\item{n_top}{Integer. Number of top pairs to plot (default 20).}

\item{fdr_thr}{Numeric. FDR threshold used to prefer significant pairs (default 0.05).}

\item{pair_column}{Which LR-pair column in \code{lr_scores} to use: \code{"pair"} (display)
or \code{"pair_human"} (both sides in human symbols).}

\item{sample_order}{Character vector. Desired column order in the heatmap. Columns not
listed will be appended after the specified order. Default:
\code{c(paste0("Control_", 1:3), paste0("Treatment_", 1:3))}.}

\item{cluster_rows}{Logical. Cluster rows? (default TRUE)}

\item{cluster_cols}{Logical. Cluster columns? (default FALSE)}

\item{scale_rows}{Logical. If TRUE, row-scale scores (i.e., \code{scale="row"}) (default TRUE).}

\item{palette}{Brewer palette name (default \code{"RdBu"}).}

\item{palette_n}{Integer. Number of colors to interpolate (default 100).}

\item{palette_rev}{Logical. Reverse palette? (default TRUE).}

\item{breaks}{Optional numeric vector of breaks passed to \code{pheatmap}. If NULL,
symmetric breaks are computed; when \code{scale_rows=TRUE}, a centered scheme in \code{[-2, 2]}
is used by default.}

\item{fontsize_row}{Numeric. Row font size (default 12).}

\item{fontsize_col}{Numeric. Column font size (default 12).}

\item{border_color}{Border color (default \code{"white"}).}

\item{show_rownames}{Logical. Show row names? (default TRUE).}

\item{...}{Additional arguments passed to \code{pheatmap::pheatmap()}.}
}
\value{
A list with three elements:
\itemize{
\item \code{pairs} — Character vector of plotted pairs (in the order used).
\item \code{matrix} — Numeric matrix (pairs × samples) used for plotting.
\item \code{plot} — The \code{pheatmap} object (invisibly returned by pheatmap).
}
}
\description{
Selects top LR pairs from statistical results and plots a pair (rows) × sample (columns)
heatmap of LR scores.
}
\details{
Pair selection logic:
\enumerate{
\item If any pairs meet the FDR threshold, take the top \code{n_top} by ascending \code{p.adj}
(ties broken by |t|).
\item Else if any pairs have finite \code{p.adj}, take the top \code{n_top} by ascending \code{p.adj}.
\item Else fall back to top \code{n_top} by descending |delta|.
}
}
